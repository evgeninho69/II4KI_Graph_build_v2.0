/* Базовые стили листа */
:root{
  --page-w: 210mm;
  --page-h: 297mm;
  --ml: 16.2mm;  /* левое поле (по DXF) */
  --mr: 9.8mm;   /* правое поле */
  --mt: 11.7mm;  /* верхнее поле */
  --mb: 9.6mm;   /* нижнее поле */
  --legend-h: 40mm;
  --header-h: 18mm;
  --line: #000;
}
html, body { height: 100%; background: #f3f3f3; }
body { margin: 20px; font: 13px/1.35 "Times New Roman", Times, serif; color: #111; }

.sheet {
  width: var(--page-w); height: var(--page-h); background: #fff; margin: 0 auto;
  box-shadow: 0 4px 24px rgba(0,0,0,.18); position: relative; border: 1px solid var(--line);
  display: grid;
  grid-template-rows: var(--mt) var(--header-h) 1fr auto 6mm auto var(--mb);
  grid-template-columns: var(--ml) 1fr var(--mr);
}

.header {
  grid-row: 2;
  grid-column: 2;
  border: 1px solid var(--line); border-bottom: none; display: flex; align-items: center; justify-content: center;
  font-weight: 700;
}

.workarea {
  grid-row: 3;
  grid-column: 2;
  border: 1px solid var(--line);
  border-bottom: none; /* Убираем нижнюю границу для стыковки */
  background: #fff; overflow: hidden;
  min-height: 100px; /* Минимальная высота для рабочей области */
}

.scale {
  grid-row: 5;
  grid-column: 2;
  text-align: center; font-weight: 700;
  border-left: 1px solid var(--line);
  border-right: 1px solid var(--line);
  background: #fff;
}

.legend {
  grid-row: 6;
  grid-column: 2;
  /* Убираем position: absolute, используем grid */
  border: 1px solid var(--line);
  border-top: none; /* Убираем верхнюю границу для стыковки */
  display: flex; flex-direction: column; 
  align-items: flex-start; justify-content: flex-start;
  padding: 4mm 8mm; font-weight: 700; 
  font-size: 9pt;
  /* Легенда автоматически подстраивает высоту, workarea сжимается */
}

.legend strong {
  font-size: 11pt;
  margin-bottom: 2mm;
  display: block;
  width: 100%;
}

/* Элементы легенды */
.legend .legend-item { 
  display: flex; align-items: center; gap: 6px; margin: 2mm 0; width: 100%;
  font-size: 9pt;
}
.legend .legend-symbol { 
  width: 50px; height: 12px; display: flex; align-items: center; justify-content: center; 
  flex-shrink: 0; /* Не сжимать символ */
  position: relative;
}
.legend .legend-item span {
  flex: 1; /* Текст занимает оставшееся пространство */
  line-height: 1.2;
  font-weight: 400;
}

/* Образцы линий границ */
.legend .legend-boundary-existing { width: 48px; height: 0; border-top: 2px solid #000; }
.legend .legend-boundary-new { width: 48px; height: 0; border-top: 2px solid #f00; }
.legend .legend-boundary-uncertain { width: 48px; height: 0; border-top: 2px dashed #000; }

/* Точки */
.legend .legend-point-new { width: 8px; height: 8px; border-radius: 50%; background: #f00; }
.legend .legend-point-existing { width: 8px; height: 8px; border-radius: 50%; background: #000; }
.legend .legend-point-removed { width: 8px; height: 8px; border-radius: 50%; background: #808080; }

/* Пункт ОМС/ГГС (упрощённый символ) */
.legend .legend-station { width: 0; height: 0; border-left: 7px solid transparent; border-right: 7px solid transparent; border-bottom: 12px solid #0077CC; }
.legend .legend-ggs { width: 0; height: 0; border-left: 7px solid transparent; border-right: 7px solid transparent; border-bottom: 12px solid #0077CC; }
.legend .legend-oms { width: 8px; height: 8px; background: #0077CC; border: 1px solid #0077CC; position: relative; }
.legend .legend-oms::after { content: ""; position: absolute; top: 1px; left: 1px; width: 6px; height: 6px; background: #0077CC; border-radius: 50%; }
.legend .legend-geodir-create { width: 48px; height: 0; border-top: 2px solid #0077CC; }
.legend .legend-geodir-determine { width: 48px; height: 0; border-top: 2px solid #0077CC; position: relative; }
.legend .legend-geodir-determine::after { content: ""; position: absolute; right: -2px; top: -6px; border-left: 8px solid #0077CC; border-top: 6px solid transparent; border-bottom: 6px solid transparent; }

/* SRZU-слои */
.legend .legend-target { 
  width: 50px; 
  height: 0; 
  border-top: 2.5px solid #ff0000; 
}
.legend .legend-adjacent { 
  width: 50px; 
  height: 0; 
  border-top: 2px solid #808080; 
}
.legend .legend-quarters { 
  width: 50px; 
  height: 0; 
  border-top: 3px solid #1E5AFF; 
}
.legend .legend-admin { 
  width: 50px; 
  height: 0; 
  border-top: 2px solid #000000; 
}
.legend .legend-zone { 
  width: 50px; 
  height: 0; 
  border-top: 2px solid #00AA00; 
}
.legend .legend-contour-part { 
  width: 50px; 
  height: 0; 
  border-top: 2px solid #8B4513; 
}
/* Текстовые образцы для номеров */
.legend .legend-label-quarter { 
  color: #1E5AFF; 
  font-weight: 700; 
  font-size: 8pt;
  display: flex;
  align-items: center;
  justify-content: center;
  width: 50px;
  height: 12px;
}
.legend .legend-label-quarter::before { 
  content: "69:18:0141401"; 
  white-space: nowrap;
  font-size: 7pt;
}
.legend .legend-label-parcel { 
  color: #000000; 
  font-size: 9pt;
  font-weight: 600;
  display: flex;
  align-items: center;
  justify-content: center;
  width: 50px;
  height: 12px;
}
.legend .legend-label-parcel::before { 
  content: ":28"; 
  white-space: nowrap;
}
/* Подписи точек */
.legend .legend-label-point-new { 
  color: #ff0000; 
  font-size: 9pt;
  font-weight: 600;
  display: flex;
  align-items: center;
  justify-content: center;
  width: 50px;
  height: 12px;
}
.legend .legend-label-point-new::before { 
  content: "н1"; 
  white-space: nowrap;
}
.legend .legend-label-point-existing { 
  color: #000000; 
  font-size: 9pt;
  font-weight: 600;
  display: flex;
  align-items: center;
  justify-content: center;
  width: 50px;
  height: 12px;
}
.legend .legend-label-point-existing::before { 
  content: "1"; 
  white-space: nowrap;
}

@media print {
  body { background: #fff; margin: 0; box-shadow: none; }
  .sheet { box-shadow: none; margin: 0; }
}


